{"componentChunkName":"component---src-templates-post-template-js","path":"/geohash-intro","result":{"data":{"markdownRemark":{"id":"68c7d645-5b88-5d5e-81bd-555f0825dc90","html":"<p>Occasionally I come across a nugget of technology that is so simple and elegant it makes me glad to be a Software Engineer. Today’s such nugget is the <a href=\"https://en.wikipedia.org/wiki/Geohash\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash system</a>, which is a simple way to encode latitude and longitude and grouping nearby points on the globe with varying resolutions. It was created by <a href=\"https://blog.labix.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Gustavo Niemeyer</a>.</p>\n<h2 id=\"simple-example\" style=\"position:relative;\"><a href=\"#simple-example\" aria-label=\"simple example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Simple Example</h2>\n<p>We have a location on the world map (see the red dot) and we want to represent this point as a single value Geohash.</p>\n<p><a href=\"https://www.psdgraphics.com/backgrounds/world-map-background/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAADJElEQVQozwEZA+b8AF1wjltvj1lvklVvlVRulFJrlFBrlk5plU9tm01unBI2ZgouXgsuXQstWwwrVwsoUgskSwsiRgwfQA4hQQBidZNgc5JbcpZbdJlceKBghrRchbZZisBYg7dOcaMUQ3wLOXMOOnILMmcKLWALKlcJJVAKI0oKIUUKH0EAZnmXZ4KlY4CnZou1Y5LDYZXJY5rQlZK/aoy/THitHVucDkiKE0uMIF+dOI7QHF6dF02EFEByEDJfCyJIAGp8mHakzny46Xu66qTM7KnD3myXxGqTxV6IvFSDuTeO00Ch5Uyt7VG9+13K/3zQ/0Ot9Tia4h9dlgskSwBwhJ9uhKNigaqv0uzL5/q53fa+0+hWib5fj8NmntRIq+1PuflYwf1nx/7E5vrP8/8neboPPHELL1wMKVMAdYijdIupZoGmx9Tipdr8c67eydnrdqPRYJXLbqzfNpPXQaLlTrf1hdT+qeT/q87pFVaVDDZtDDRlCyxYAHmMpneOrHGNscjW5ZvE5W2ayMfW6ICq1Geh1n/G9Uex9EWw8z2c3z2l6GLA+aW/2AY/fg8/dww0ZwstWQB8j6d8kaxyjq/J1eOMqcpvos/T5/d+qNNsotV0teZFtPk2oukVarUMX6tBhcKlv9kIQYAOPXUMM2ULLFgAgJCngJOsdY6tq73RwtHisszjz+3/erLgcp/NZ5jLMZ3lHoTPEV+pBlSeNnCqqcPbDlaYDjpvDDJiCypUAIWQpYOTqoKVrnyUsqa4zq/D2Im+53mm0XWeyG6ZyB53vxBirA9Vmw1PlBlPjESSzBR9ywo1awwsWAsnTwCGkaOFk6eDlauCl7B6ka91l7t9p856mL15nMNxl8AXU5QKSYwOSooORYMLP3sHO3YMRYAIMWQMLFcLI0oAhpChhpGjhpSmhZarhpivg5u3gJu6fpe3fZm6dZS4GUyFCj97DT13DTpyDTdsDzRkCypXCylTCyVMCx9CAIaPn4aQoIaRo4aTpYaVqYWVrIOVr4KWsYKXsnmRrhhAcgozaA00ZwwxYgwvXQwrVwsnUAskSQsgQgsdPLwNdyDNJL+0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/4cef886ce08f9a974a0aa0d99c57d4fe/8ac56/geohash-0.webp 240w,\n/static/4cef886ce08f9a974a0aa0d99c57d4fe/d3be9/geohash-0.webp 480w,\n/static/4cef886ce08f9a974a0aa0d99c57d4fe/b0a15/geohash-0.webp 500w\"\n          sizes=\"(max-width: 500px) 100vw, 500px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/4cef886ce08f9a974a0aa0d99c57d4fe/8ff5a/geohash-0.png 240w,\n/static/4cef886ce08f9a974a0aa0d99c57d4fe/e85cb/geohash-0.png 480w,\n/static/4cef886ce08f9a974a0aa0d99c57d4fe/0b533/geohash-0.png 500w\"\n          sizes=\"(max-width: 500px) 100vw, 500px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/4cef886ce08f9a974a0aa0d99c57d4fe/0b533/geohash-0.png\"\n          alt=\"geohash 0\"\n          title=\"geohash 0\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></a></p>\n<p>First we divide the world into two halves with a vertical line and give each half a binary value of either 0 or 1. Our point on the map is in the “0″ half.</p>\n<p>At this point we could be very unhelpful and say that the Geohash is “0″. This is lowest resolution Geohash. Obviously this is not much use if you are trying to locate a party on Saturday night and your friend tells you that the party is on the west half of planet. If he does, then take the hint and stay home.</p>\n<p>Let’s improve the resolution of our Geohash…</p>\n<p>Next we sub-divide our “0″ half of planet into two halves with a horizontal line and assign each half a “0″ or “1″. </p>\n<p><a href=\"https://www.psdgraphics.com/backgrounds/world-map-background/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 384px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 130.41666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/a3daa13f84b95df7de853a698302420d/8ac56/geohash-00.webp 240w,\n/static/a3daa13f84b95df7de853a698302420d/e6f2f/geohash-00.webp 384w\"\n          sizes=\"(max-width: 384px) 100vw, 384px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/a3daa13f84b95df7de853a698302420d/8ff5a/geohash-00.png 240w,\n/static/a3daa13f84b95df7de853a698302420d/804b2/geohash-00.png 384w\"\n          sizes=\"(max-width: 384px) 100vw, 384px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/a3daa13f84b95df7de853a698302420d/804b2/geohash-00.png\"\n          alt=\"geohash 00\"\n          title=\"geohash 00\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></a></p>\n<p>We can see our red dot is located in the “0″ half, so we have a higher resolution Geohash of “00″ (“0″ from the first division, and “0″ from the sub-division).</p>\n<p>Great! Your chances of attending the party have doubled, but we will need to raise the resolution further to pin-point more accurately.</p>\n<p><a href=\"https://www.psdgraphics.com/backgrounds/world-map-background/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAADJElEQVQozwEZA+b8AHB8lG57lWt7lWt7lWp7lmh6l2Z6mGV5mWN4mWh9njdPdgQhTgsqVwknVgoqWgorWgssXAstXgsuXwsvXwBwgJZwfpZvfpdtfphsfZhrfJlpfJpofJtle5xqgaI5U3sGJ1YMLV0MMGELMGIKLV8MMWQMMmYMMWYMMmYAcoGYcoGYcYGZcICbb4CbbYCba4CeaoCfaH6fbIOkNlB3AyRUCi1fBCRXBCFYDCtjCjNrCjNpDDduDThwAHWEmnSDm3OEnHKEn3GEoHCDoG2Bn2yCoWqBo3SNr0+FuCh4wCx3vSZrsSd4wy6e9C5/yxdQjgw7dQw7dgB4hpt3hZ11hJ1zgppxg51wgZ1zi6p3mLxykbV+ocVfpd8bXZ0obrJEs/1Wq/J3frxHrPoXVZcIO3sLQYEAeYieeYede46pfpq6d5GwdYyqe5q+hLDZe6HJfqDFWpvRJnOzDTdwGGera5PPzTVHP5DWCUWIDEeLDEiMAHuLoHmGnIWpy5bW/5TR/ZHL94/D7Yq95Y3E7pLH7lOKvCVvry16uxZTllG//iqJ0RJYoBdboQtLkwtKkgB9jaN6iaCEpcONv+SDrdOt1/W/5f2czfGV0vyUxuw8YpQxg8QocrMKR4wkc7kTTpJ1m8UgZakJT5gZZawAgI+lf4+mfpKrjqG4kZqxssXaq9n3tOD8ks/3ntT3WZPFRqTjVbr4MXGvPm+nJWaocp7IHmOoHnO6H3G5AIKRpoCRqX+RqqKvw7K+0K+7zbPM4a3g/5rU+aPW+HG56VrE/kCb2UeDu4CnzjBysk6IvyFqsBZqtUe29wCDkqeCkqqBk6uGmbKGmrR/k66YudWg2/+g1fqm2Pt5we5Go+AYX6UQWKEdZqwVY6sZaLEQYa4ukNcri9IAhZOohJSqg5WtgZWvgZayfZOye5i5nM/wo9z+qdz7hNH9H22yClCbDl6pDF2pD2KvD2a1DGGxMpfdO6frAISTqYWUq4WXrYSZsYOatYOcuH+Zt4Wmx6HW95W83VKHuw1XoBBcpxFgqhJlrxJotQ9mtB16xUi7/EvA/62pi1yR08/NAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/7aeee51f7e2fd43ed22a39c0341d8d97/8ac56/geohash-001.webp 240w,\n/static/7aeee51f7e2fd43ed22a39c0341d8d97/d3be9/geohash-001.webp 480w,\n/static/7aeee51f7e2fd43ed22a39c0341d8d97/b0a15/geohash-001.webp 500w\"\n          sizes=\"(max-width: 500px) 100vw, 500px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/7aeee51f7e2fd43ed22a39c0341d8d97/8ff5a/geohash-001.png 240w,\n/static/7aeee51f7e2fd43ed22a39c0341d8d97/e85cb/geohash-001.png 480w,\n/static/7aeee51f7e2fd43ed22a39c0341d8d97/0b533/geohash-001.png 500w\"\n          sizes=\"(max-width: 500px) 100vw, 500px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/7aeee51f7e2fd43ed22a39c0341d8d97/0b533/geohash-001.png\"\n          alt=\"geohash 001\"\n          title=\"geohash 001\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></a></p>\n<p>Another sub-division gives us a location of “001″ (“0″ from the first division, and “0″ from the first sub-division and “1″ from this second sub-division).</p>\n<p>I hope that you are getting the idea by now.</p>\n<p>Note that each sub-division switches between dividing vertically and horizontally, dividing longitude and latitude alternately. This interweaves the longitude and latitude information to give a single value.</p>\n<p>We can keep sub-dividing the space until we get to street-level or beyond. At that point our Geohash will be a bit longer and will look something like this…</p>\n<pre class=\"grvsc-container monokai\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">0010110101011100011000110001101111000111</span></span></code></pre>\n<p>This binary can be represented as alphanumeric characters (32 bit encoded). Each 5 bits is converted to one character.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">00101  10101  01110  00110  00110  00110  11110  00111</span></span></code></pre>\n<p>Which comes out as</p>\n<pre class=\"grvsc-container monokai\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">  5      p      f      6      6      6      y      7</span></span></code></pre>\n<p>So our Geohash for the party on Saturday night is “5pf666y7″.</p>\n<p>That’s great, but how does that help us?</p>\n<h2 id=\"why-use-a-geohash\" style=\"position:relative;\"><a href=\"#why-use-a-geohash\" aria-label=\"why use a geohash permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why Use A GeoHash?</h2>\n<h3 id=\"single-simple-string-representation\" style=\"position:relative;\"><a href=\"#single-simple-string-representation\" aria-label=\"single simple string representation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Single Simple String Representation</h3>\n<p>A Geohash is fairly short and concise and does not have to be a precise location. It looks similar to a URL shortener string, such as <a href=\"https://bit.ly/12C5kv\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://bit.ly/<strong>12C5kv</strong></a>, and can be passed around on social networks such as Twitter.</p>\n<h3 id=\"grouping-of-points\" style=\"position:relative;\"><a href=\"#grouping-of-points\" aria-label=\"grouping of points permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Grouping Of Points</h3>\n<p>This is my favorite part about the Geohash system. Geohashs can easily to grouped. No <a href=\"https://en.wikipedia.org/wiki/Distance\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">advanced algorithms</a> needed.</p>\n<p>It is as simple as saying, <em>which other points have a Geohash that starts with the prefix “5pf66″?</em>. The longer the prefix the higher resolution we can zoom to.</p>\n<h3 id=\"zooming-and-aggregation\" style=\"position:relative;\"><a href=\"#zooming-and-aggregation\" aria-label=\"zooming and aggregation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Zooming And Aggregation</h3>\n<p>If we want to zoom in and out on a map and show a summary of how many points there are on grid square, then we can use a Geohash prefix length that is relative to the zoom resolution</p>\n<p>In this example we use a prefix of 2 characters, which will give us the world map divided into 64 (2×32) grid squares, and a count of the number of points found in each one.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">SELECT SUBSTR(geohash, 0, 2), COUNT(*) FROM locations GROUP BY SUBSTR(geohash, 0, 2);</span></span></code></pre>\n<pre class=\"grvsc-container monokai\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;aa&quot;, 67</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;ab&quot;, 456</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;ac&quot;, 128</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;ad&quot;, 994</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;ae&quot;, 12</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;zx&quot;, 0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;zy&quot;, 8</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&quot;zz&quot;, 5</span></span></code></pre>\n<p>A simple index on the <strong>geohash</strong> column of the above <strong>locations</strong> table allows us to focus any queries on specific areas on the map.</p>\n<h3 id=\"caching-at-scale\" style=\"position:relative;\"><a href=\"#caching-at-scale\" aria-label=\"caching at scale permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Caching At Scale</h3>\n<p>A question I often ask when looking at using technologies, is “<a href=\"https://highscalability.com/blog/2010/9/5/hilarious-video-relational-database-vs-nosql-fanbois.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">how does it scale</a>“? Can the data be partitioned? Can we cache the results? The Geohash system provides this through simply prefixes.</p>\n<p>You can be sure that Google heavily caches all the grid squares on Google Maps at the various resolutions they provide.</p>\n<p>All point data that relates to a specific grid square at a specific resolution can be cached by using that grid square’s geohash value. Using this single value, rather than 4 non-discrete co-ordinates values (top, left, bottom, right), we can use a key-value datastore (HBase, MongoDB, Cassandra, Memcached, CouchBase, Memcached.. ) to store and quickly retrieve all information on that grid-square.</p>\n<p>From our above example, if we were to update the party location details at Geohash location “5pf666y7″, we could then quickly update the aggregate information at the lower resolutions “5pf666y”, “5pf666″, “5pf66″, “5pf6″, “5pf”, “5p” and “5″. By doing this pre-computation we could have that data ready to be served up as-is from our key-value store, as the users of our website zoom in-and-out and move around the map.</p>\n<h2 id=\"finding-nearest-points\" style=\"position:relative;\"><a href=\"#finding-nearest-points\" aria-label=\"finding nearest points permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Finding Nearest Points</h2>\n<p>An index of geohash values will store the geohashs in alphanumeric order. This means nearest points are the closest strings. This makes the 2D problem a much simplier 1D problem (see <a href=\"/geohash-intro#the-gotcha\">“The Gotcha!”</a>)</p>\n<pre class=\"grvsc-container monokai\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">22rt841  &lt;-- Far way party</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">5pf666y  &lt;-- Somebody else&#39;s party nearby</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">5pf666y  &lt;-- Our party</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">5pf666y  &lt;-- Another nearby party</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">5r84ew3  &lt;-- Not so close party</span></span></code></pre>\n<h3 id=\"the-gotcha\">The Gotcha!</h3>\n<p>You get extra points if you have already spotted the problem with finding nearest neighbours.</p>\n<p>The nearest point can have wildly different Geohash value, if the location is close to a grid-square boundary. This is similar to two nearby houses that reside on opposite sides of an international border (eg. Canada and USA). There will be no commonality in the addresses of these two houses.</p>\n<p><a href=\"https://www.psdgraphics.com/backgrounds/world-map-background/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAADJElEQVQozwEZA+b8AF1wjlpvj1lvklZvlFRulVJslFBrlU5qlU9umkxunBE1ZwkuXwstXQstWwsrWAwoUgskSwsiRwsfQA0hQwBhdJNfcpJccpVadJlceKBghbNchrZaiLxXgrZMcqQUQ30LOnMNOnIJMmgKLmELKlgIJFAKIksKIUYJH0IAZniXZ4KlY4CnZou1Y5LDYpXKZZjMeL33YpfOTXaqHVydDUiJE0yLIV+cOo7PHF6dF02EE0BzEDJfCiJIAGp8mXakz3y46Xu666XM7KnD3muWxGWbzlyLv1SDuDiO0kCg5E6t7VK8+17J/33P/0Ou9Tia4R5dlgolTABvg6BuhKRjgamv0uzL5/q53fa+0uhXhr1fjsRmntZGrfBQufpZwP1nx/7E5vrP8/8neboPPHELLlwLKVMAdIijc4uoZoGlx9Tiptr7c67dydnrdqPRYJXMa6nUPonIQaPmTrb1hdP+qeT/q87pFVeVDDdtDDRlDCtYAHmMpneOrHGOsMjW5ZzE5W2ayMfW6ICq1Gej2m62uGyAp0aw9j6c3z6l6GPA+aW/2Qc/fhBAdws1ZwssWQB9jqh8kaxyja/J1eKMqslvoc/T5/d+qNNrodR1tehCt/w2oukWarUNX6tBhsKkv9kJQYAOPXQLM2UMLFcAgJCmgJOsdY6urL3RwtHissvjz+3+erPfcZ7NZ5jKMZzkHoTPEV+pB1SfNnCqqsPbD1aYDjpvDDJiDCpTAISRpYKTqoCVrnuUsqa4zrDD2Im+53mm0HWeyG6ZyB93vxBirQ9VnAxPlBlPjEWSzBR9ywo1awwsWAwnTgCGkaOFk6aDlauCl7B6ka91l7x9p856mL15nMNyl8AXVJUKSYwOSYoORYMMP3sGO3YMRYEIMWUMLFcLJEkAhpChhpGjhpSmhZarhpivg5u3f5q6fpi3fZm6dpO4GUyGCz97Dj53DTtzDTdtDzNkCypXDClTCyZMCSBFAIaPn4aQoIaRo4aTpYaVqYWVrIOVroGWsYGXs3mRrxdAcwkzaA00ZwwxYgsuXQwqVwsnTwskSQkgRQgdP1FZdrTVXJC+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/b733a5e7d98e581b46bc02a4dcf9f623/8ac56/geohash-gotcha.webp 240w,\n/static/b733a5e7d98e581b46bc02a4dcf9f623/d3be9/geohash-gotcha.webp 480w,\n/static/b733a5e7d98e581b46bc02a4dcf9f623/b0a15/geohash-gotcha.webp 500w\"\n          sizes=\"(max-width: 500px) 100vw, 500px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/b733a5e7d98e581b46bc02a4dcf9f623/8ff5a/geohash-gotcha.png 240w,\n/static/b733a5e7d98e581b46bc02a4dcf9f623/e85cb/geohash-gotcha.png 480w,\n/static/b733a5e7d98e581b46bc02a4dcf9f623/0b533/geohash-gotcha.png 500w\"\n          sizes=\"(max-width: 500px) 100vw, 500px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/b733a5e7d98e581b46bc02a4dcf9f623/0b533/geohash-gotcha.png\"\n          alt=\"geohash gotcha\"\n          title=\"geohash gotcha\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></a></p>\n<p>In this example above you can see that these 2 locations (green dot and red dot) are pretty close, but they on opposite sides of a boundary. Immediately they will start with opposite binary values. Many subsequent horizontal divisions will see the green dot on the far right (“1″) of the division and the red dot on the far left (“0″). There will be very little correlation in the geohash values of these two neighbouring dots.</p>\n<h3 id=\"the-gotcha-solution\" style=\"position:relative;\"><a href=\"#the-gotcha-solution\" aria-label=\"the gotcha solution permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Gotcha Solution</h3>\n<p>Fear not, the smart people at the institute of super smart people have a solution for you. There is an algorithm for calculating the geohash values of the 8 surrounding grid-squares of a given grid square, which widens our search net in all directions, allowing us to see nearby points that reside on the other side of a grid’s boundary.</p>\n<h2 id=\"resources\" style=\"position:relative;\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resources</h2>\n<ul>\n<li><a href=\"https://www.lucidimagination.com/sites/default/files/Lucene%20Rev%20Preso%20Smiley%20Spatial%20Search.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spatial Search with Geohashes – David Smiley, MITRE (Lucene Revolution)</a></li>\n<li><a href=\"https://github.com/davetroy/geohash-js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash implementation in JavaScript</a></li>\n<li><a href=\"https://github.com/davetroy/geohash\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash implementation in Ruby</a></li>\n<li><a href=\"https://github.com/kungfoo/geohash-java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash implementation in Java</a></li>\n<li><a href=\"https://code.google.com/p/python-geohash/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash implementation in Python</a></li>\n<li><a href=\"https://search.cpan.org/dist/Net-Geohash/lib/Net/Geohash.pm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash implementation in Perl</a></li>\n<li><a href=\"https://github.com/mumoshu/geohash-scala\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash implementation in Scala</a></li>\n<li><a href=\"https://bitbucket.org/sunng/clojure-geohash\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geohash implementation in Clojure</a></li>\n</ul>\n<h2 id=\"comments\" style=\"position:relative;\"><a href=\"#comments\" aria-label=\"comments permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Comments</h2>\n<div id=\"comments\">\n  <ol class=\"comment-list\">\n    <li id=\"comment-58314\" class=\"comment even thread-even depth-1 comment reader\">\n      <img alt=\"George\" src=\"https://0.gravatar.com/avatar/e79cac53f6398497534d2e1bab788dc8?s=80&amp;d=https%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D80&amp;r=PG\" class=\"avatar avatar-80 photo\" height=\"80\" width=\"80\">\n      <div class=\"comment-meta comment-meta-data\">\n        <div class=\"comment-author vcard\">\n          <cite class=\"fn\">George</cite>\n        </div>\n        <!-- .comment-author .vcard -->\n        <abbr class=\"comment-date\" title=\"Friday, August 9th, 2013, 8:19 pm\">August 9, 2013</abbr> at <abbr class=\"comment-time\" title=\"Friday, August 9th, 2013, 8:19 pm\">8:19 pm</abbr>\n      </div>\n      <div class=\"comment-text\">\n        <p>Wonderfully written explanation, makes it so even a math noob can understand without treating the audience like an idiot.</p>\n        <p>One thing, it&#x2019;s always nice to know a little history of how you found it (brief &amp; undetailed of course) in a piece written informally, adds a nice human element.</p>\n        <p>I especially love your infographics and your description of the location codes, so clear, so pretty.</p>\n      </div>\n      <!-- .comment-text -->\n    </li>\n    <!-- .comment -->\n  </ol>\n  <!-- .comment-list -->\n</div>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","fields":{"slug":"/geohash-intro","tagSlugs":["/tag/clojure/","/tag/geo/","/tag/geographic/","/tag/geohash/","/tag/geospatial/","/tag/java/","/tag/javascript/","/tag/key-value/","/tag/location/","/tag/maps/","/tag/memcached/","/tag/nearest-neighbour/","/tag/perl/","/tag/python/","/tag/ruby/","/tag/scala/","/tag/search/"]},"frontmatter":{"date":"2011-12-15T23:53:00-08:00","description":"Geohashing is a simple way to encode latitude and longitude and grouping nearby points on the globe with varying resolutions. It was created by Gustavo Niemeyer. This blog post looks at how it's implemented any why it is such an elegant solution for encoding and managing location-based data.","tags":["clojure","geo","geographic","geohash","geospatial","java","javascript","key-value","location","maps","memcached","nearest neighbour","perl","python","ruby","scala","search"],"title":"Geohash Intro","socialImage":{"publicURL":{"publicURL":"/static/b712766ea4e6fd05c4a775609e13ad83/geohash_intro_sq.jpg"}}}}},"pageContext":{"slug":"/geohash-intro"}},"staticQueryHashes":["251939775","3942705351","401334301"]}